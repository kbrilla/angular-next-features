import{Db as s,Eb as c,Ia as b,La as y,ab as n,bb as t,ca as S,cb as f,ib as E,qb as e,rb as o,ya as d}from"./chunk-XVUB2EYR.js";var h=class m{transform(a){return a===null?"null":a===void 0?"undefined":String(a)}static \u0275fac=function(r){return new(r||m)};static \u0275pipe=y({name:"stringifyNullish",type:m,pure:!0})},C=class m{currentUser=S(null);userWithAddress={id:1,name:"Alice Johnson",email:"alice@example.com",address:{street:"123 Main St",city:"New York",zip:"10001",country:{name:"United States",code:"US"}}};userWithoutAddress={id:2,name:"Bob Smith",email:"bob@example.com"};setUserWithAddress(){this.currentUser.set(this.userWithAddress)}setUserWithoutAddress(){this.currentUser.set(this.userWithoutAddress)}setNullUser(){this.currentUser.set(null)}ngOnInit(){this.setUserWithAddress()}static \u0275fac=function(r){return new(r||m)};static \u0275cmp=b({type:m,selectors:[["app-optional-chaining-legacy-demo"]],decls:207,vars:14,consts:[[1,"demo-container"],[1,"badge","legacy"],[1,"description"],[1,"example-section"],[1,"code-row"],[1,"arrow"],[1,"result"],[1,"note"],[1,"example-section","pitfall"],[1,"warning"],[1,"migration-list"],[1,"migration-item"],[1,"diag-msg"],[1,"config-list"],[1,"config-row"],[1,"config-where"],[1,"config-scope"],[1,"controls"],[3,"click"],[1,"null-btn",3,"click"]],template:function(r,i){if(r&1&&(n(0,"div",0)(1,"h2"),e(2,"Legacy Safe Navigation (default Angular behavior)"),t(),n(3,"span",1),e(4,"optionalChainingSemantics: 'legacy'"),t(),n(5,"p",2),e(6," With legacy semantics, "),n(7,"code"),e(8,"a?.b"),t(),e(9," returns "),n(10,"code"),e(11,"null"),t(),e(12," when "),n(13,"code"),e(14,"a"),t(),e(15," is nullish. This is the traditional Angular behavior. "),t(),n(16,"div",3)(17,"h3"),e(18,"Simple Property Access"),t(),n(19,"div",4)(20,"code"),e(21,"user?.name"),t(),n(22,"span",5),e(23,"\u2192"),t(),n(24,"span",6),e(25),t()(),n(26,"div",4)(27,"code"),e(28,"user?.email"),t(),n(29,"span",5),e(30,"\u2192"),t(),n(31,"span",6),e(32),s(33,"stringifyNullish"),t()()(),n(34,"div",3)(35,"h3"),e(36,"Deep Chain Access"),t(),n(37,"div",4)(38,"code"),e(39,"user?.address?.city"),t(),n(40,"span",5),e(41,"\u2192"),t(),n(42,"span",6),e(43),s(44,"stringifyNullish"),t()(),n(45,"div",4)(46,"code"),e(47,"user?.address?.country?.name"),t(),n(48,"span",5),e(49,"\u2192"),t(),n(50,"span",6),e(51),s(52,"stringifyNullish"),t()()(),n(53,"div",3)(54,"h3"),e(55,"Null Coalescing with Legacy ?."),t(),n(56,"p",7)(57,"code"),e(58,"??"),t(),e(59," catches both "),n(60,"code"),e(61,"null"),t(),e(62," and "),n(63,"code"),e(64,"undefined"),t(),e(65,", so it works safely regardless of the semantics mode. "),t(),n(66,"div",4)(67,"code"),e(68,"user?.address?.city ?? 'N/A'"),t(),n(69,"span",5),e(70,"\u2192"),t(),n(71,"span",6),e(72),t()()(),n(73,"div",8)(74,"h3"),e(75,"Strict Equality Pitfall"),t(),n(76,"p",9),e(77," With legacy: "),n(78,"code"),e(79,"user?.missing === null"),t(),e(80," is "),n(81,"code"),e(82,"true"),t(),e(83," (returns null)."),f(84,"br"),e(85," With native: "),n(86,"code"),e(87,"user?.missing === null"),t(),e(88," is "),n(89,"code"),e(90,"false"),t(),e(91," (returns undefined)."),f(92,"br"),e(93," This is the key behavioral difference the PR addresses! "),t()(),n(94,"div",3)(95,"h3"),e(96,"Key Index Access (?.[])"),t(),n(97,"div",4)(98,"code"),e(99,"user?.address?.['city']"),t(),n(100,"span",5),e(101,"\u2192"),t(),n(102,"span",6),e(103),s(104,"stringifyNullish"),t()(),n(105,"p",7)(106,"code"),e(107,"?.[key]"),t(),e(108," expressions are supported with native semantics. The migration schematic auto-converts simple chains but flags "),n(109,"code"),e(110,"?.[]"),t(),e(111," patterns for manual review. "),t()(),n(112,"div",3)(113,"h3"),e(114,"Migration Schematic"),t(),n(115,"p",2),e(116," The "),n(117,"code"),e(118,"optional-chaining-semantics-migration"),t(),e(119," schematic auto-converts safe navigation chains. It uses AST-based analysis (not regex) and handles: "),t(),n(120,"div",10)(121,"div",11)(122,"code"),e(123,"a?.b"),t(),e(124," \u2192 "),n(125,"code"),e(126,"a?.b"),t(),e(127," (no change needed for simple chains)"),t(),n(128,"div",11)(129,"code"),e(130,"a?.b === null"),t(),e(131," \u2192 "),n(132,"code"),e(133,"a?.b == null"),t(),e(134," (loose equality)"),t(),n(135,"div",11)(136,"code"),e(137,"a?.b !== null"),t(),e(138," \u2192 "),n(139,"code"),e(140,"a?.b != null"),t(),e(141," (loose inequality)"),t(),n(142,"div",11)(143,"code"),e(144,"a?.b ?? fallback"),t(),e(145," \u2192 unchanged (already nullish-safe)"),t()(),n(146,"p",7),e(147," Run with: "),n(148,"code"),e(149,"ng generate @angular/core:optional-chaining-semantics-migration"),t(),e(150,". The schematic modifies templates but not component class code. Supports "),n(151,"code"),e(152,"!."),t(),e(153," patterns and negated ternary expressions in null-safe detection. "),t()(),n(154,"div",3)(155,"h3"),e(156,"Extended Diagnostic: legacySafeNavigationUsage (NG8119)"),t(),n(157,"p",2),e(158," When "),n(159,"code"),e(160,"strictOptionalChainingSemantics"),t(),e(161," is NOT enabled, the language service produces a warning on every "),n(162,"code"),e(163,"?."),t(),e(164," usage that would behave differently with native semantics. "),t(),n(165,"div",4)(166,"span",12),e(167,"NG8119: This safe navigation expression uses legacy Angular semantics (returns 'null' on short-circuit). With 'strictOptionalChainingSemantics' enabled, it would return 'undefined' instead."),t()(),n(168,"p",7),e(169," The diagnostic can be configured via "),n(170,"code"),e(171,"extendedDiagnostics"),t(),e(172," in tsconfig: "),n(173,"code"),e(174,'"legacySafeNavigationUsage": "warning" | "error" | "suppress"'),t()()(),n(175,"div",3)(176,"h3"),e(177,"Configuration Options"),t(),n(178,"div",13)(179,"div",14)(180,"span",15),e(181,"tsconfig.json"),t(),n(182,"code"),e(183,'"strictOptionalChainingSemantics": true'),t(),n(184,"span",16),e(185,"Project-wide"),t()(),n(186,"div",14)(187,"span",15),e(188,"@Component"),t(),n(189,"code"),e(190,"optionalChainingSemantics: 'native'"),t(),n(191,"span",16),e(192,"Per-component override"),t()(),n(193,"div",14)(194,"span",15),e(195,"@Component"),t(),n(196,"code"),e(197,"optionalChainingSemantics: 'legacy'"),t(),n(198,"span",16),e(199,"Opt-back to legacy"),t()()()(),n(200,"div",17)(201,"button",18),E("click",function(){return i.setUserWithAddress()}),e(202,"User with Address"),t(),n(203,"button",18),E("click",function(){return i.setUserWithoutAddress()}),e(204,"User without Address"),t(),n(205,"button",19),E("click",function(){return i.setNullUser()}),e(206,"Null User"),t()()()),r&2){let l,v,u,p,x,g;d(25),o((l=i.currentUser())==null?null:l.name),d(7),o(c(33,6,(v=i.currentUser())==null?null:v.email)),d(11),o(c(44,8,(u=i.currentUser())==null||u.address==null?null:u.address.city)),d(8),o(c(52,10,(p=i.currentUser())==null||p.address==null||p.address.country==null?null:p.address.country.name)),d(21),o(((x=i.currentUser())==null||x.address==null?null:x.address.city)??"N/A"),d(31),o(c(104,12,(g=i.currentUser())==null||g.address==null?null:g.address.city))}},dependencies:[h],styles:[".demo-container[_ngcontent-%COMP%]{max-width:900px;margin:0 auto;padding:32px 32px 64px}.badge[_ngcontent-%COMP%]{display:inline-block;padding:3px 10px;border-radius:6px;font-size:11px;font-weight:600;font-family:JetBrains Mono,monospace}.legacy[_ngcontent-%COMP%]{background:#fbbf241f;color:#fbbf24;border:1px solid rgba(251,191,36,.25)}.description[_ngcontent-%COMP%]{color:var(--adev-text-secondary);line-height:1.6}code[_ngcontent-%COMP%]{background:var(--adev-code-bg);border:1px solid var(--adev-code-border);padding:2px 6px;border-radius:4px;font-size:13px;color:var(--adev-primary)}.example-section[_ngcontent-%COMP%]{background:var(--adev-surface);border:1px solid var(--adev-border);border-left:3px solid var(--adev-warning);padding:20px;margin:20px 0;border-radius:8px}.example-section.pitfall[_ngcontent-%COMP%]{border-left-color:var(--adev-error)}h3[_ngcontent-%COMP%]{color:var(--adev-text);margin-top:0;font-size:16px;font-weight:600}.code-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;background:var(--adev-surface-2);padding:10px 12px;border-radius:6px;margin:8px 0;font-size:14px}.arrow[_ngcontent-%COMP%]{color:var(--adev-text-tertiary);font-size:18px}.result[_ngcontent-%COMP%]{font-weight:600;color:var(--adev-warning)}.note[_ngcontent-%COMP%]{background:#60a5fa14;border-left:3px solid var(--adev-info);padding:10px 14px;border-radius:6px;font-size:13px;color:var(--adev-text-secondary)}.warning[_ngcontent-%COMP%]{background:#f8717114;border-left:3px solid var(--adev-error);padding:10px 14px;border-radius:6px;font-size:13px;color:var(--adev-text-secondary)}.controls[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:16px;flex-wrap:wrap}button[_ngcontent-%COMP%]{background:var(--adev-accent);color:#fff;border:none;padding:8px 16px;border-radius:6px;cursor:pointer;font-size:13px}button[_ngcontent-%COMP%]:hover{opacity:.85}.null-btn[_ngcontent-%COMP%]{background:var(--adev-error)}.migration-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;margin:8px 0}.migration-item[_ngcontent-%COMP%]{background:var(--adev-surface-2);padding:8px 12px;border-radius:6px;font-size:13px}.diag-msg[_ngcontent-%COMP%]{color:var(--adev-warning);font-style:italic;font-size:13px;line-height:1.6}.config-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.config-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;background:var(--adev-surface-2);padding:8px 12px;border-radius:6px;font-size:13px;flex-wrap:wrap}.config-where[_ngcontent-%COMP%]{font-size:11px;font-weight:700;color:var(--adev-text-tertiary);min-width:100px}.config-scope[_ngcontent-%COMP%]{font-size:11px;color:var(--adev-text-tertiary);margin-left:auto}"]})};export{C as OptionalChainingLegacyDemoComponent,h as StringifyNullishLegacyPipe};
